<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Combined Bookmarklet Test + Lostsec Scanner</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      background-color: black;
      color: #00ff88;
      font-family: monospace;
      padding: 20px;
    }
    input, button {
      font-family: monospace;
      margin-top: 5px;
      margin-bottom: 20px;
      padding: 6px 8px;
      font-size:14px;
    }
    .hidden { display: none; }
    .grayed { pointer-events: none; opacity: 0.4; }
    .tools {
      margin: 12px 0;
      padding: 10px;
      border: 1px solid #00ff88;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      background:#0a0a0a;
    }
    .tools button {
      cursor: pointer;
      background: #111;
      color: #00ff88;
      border: 1px solid #00ff88;
      border-radius: 4px;
    }
    #lostsec-scanner .btn {
      padding:5px 8px;
      border-radius:3px;
      border: none;
      background:#222;
      color:#00bcd4;
      cursor:pointer;
      margin-right:6px;
    }
    #results-wrapper div { color:#fff; margin:4px 0; padding:5px; background:#333; border-radius:3px; word-break:break-all; }
    #results { color:#00bcd4; }
  </style>
</head>
<body>
  <h1>Bookmarklet Test Page</h1>

  <div class="tools">
    <button onclick="unhide()">â–¶ Unhide Elements</button>
    <button onclick="runLostsec()">â–¶ Lostsec Scanner</button>
    <label style="color:#00ff88"><input id="start-domain-only" type="checkbox" /> Domain only</label>
  </div>

  <h2>Disabled Input</h2>
  <label>Email (Disabled):<br>
    <input type="text" value="you@nowhere.com123" disabled>
  </label>

  <h2>Readonly Input</h2>
  <label>Username (Readonly):<br>
    <input type="text" value="readonly_user123" readonly>
  </label>

  <h2>Hidden Button</h2>
  <button class="hidden" id="secret-btn">Secret Admin Button</button>

  <h2>Grayed-Out Section</h2>
  <div class="grayed">Premium Content</div>

  <script>
    // --- Unhide Elements (first bookmarklet)
    function unhide() {
      document.querySelectorAll('[disabled],[readonly]').forEach(el=>{
        el.removeAttribute('disabled');
        el.removeAttribute('readonly');
      });
      document.querySelectorAll('[style*="display: none"],.hidden').forEach(el=>{
        el.style.display='block';
      });
      document.querySelectorAll('[style*="pointer-events: none"],.grayed').forEach(el=>{
        el.style.pointerEvents='auto';
        el.style.opacity='1';
      });
      alert('âœ… Disabled, readonly, and hidden elements are now active!');
    }

    // --- Run Lostsec scanner (injects full panel)
    function runLostsec(){
      (function(){
        if(document.getElementById('lostsec-scanner'))return;
        let e=!1,t=[],n=document.createElement('div');
        n.id='lostsec-scanner';
        n.style='position:fixed;bottom:0;left:0;width:100%;height:350px;background:#181818;color:#00bcd4;z-index:999999;padding:20px;font-family:monospace;box-shadow:0 -2px 10px rgba(0,0,0,0.7);border-top:2px solid #00bcd4;overflow:hidden;';
        let o=document.createElement('div');
        o.style='position:absolute;top:0;left:0;width:100%;height:10px;background:#222;cursor:ns-resize;';
        n.appendChild(o);
        let i=!1,a=0,l=0;
        o.addEventListener('mousedown',r=>{i=!0,a=r.clientY,l=n.offsetHeight,r.preventDefault()});
        function d(r){if(i){let d=l-(r.clientY-a);d=Math.max(200,Math.min(d,window.innerHeight*.9)),n.style.height=d+'px';let s=document.getElementById('results-wrapper');s&&(s.style.maxHeight=d-140+'px')}}function c(){i=!1}
        document.addEventListener('mousemove',d),document.addEventListener('mouseup',c);
        let s=document.createElement('div');s.textContent='âŒ',s.style='position:absolute;top:10px;right:20px;font-size:18px;color:#ff4081;cursor:pointer;';
        function u(){e=!0,document.removeEventListener('mousemove',d),document.removeEventListener('mouseup',c),document.removeEventListener('keydown',f),n.remove(),t.forEach(e=>e.abort())}
        s.onclick=u,n.appendChild(s);
        let m=document.createElement('h3');m.textContent='ðŸ” Lostsec Uncover',m.style='margin:10px 0;color:#00bcd4;',n.appendChild(m);
        let v=document.createElement('input');v.placeholder='Search URLs...',v.style='width:100%;padding:6px;margin-bottom:10px;border-radius:4px;border:none;font-size:14px;outline:none;background:#222;color:#00bcd4;',n.appendChild(v);
        let y=document.createElement('div');y.style='margin-bottom:10px;display:flex;gap:10px;flex-wrap:wrap;';
        let h=document.createElement('button');h.className='btn';h.textContent='ðŸ“‹ Copy All';
        let g=document.createElement('button');g.className='btn';g.textContent='â¬‡ï¸ Export .txt';
        let z=document.createElement('button');z.className='btn';z.textContent='ðŸª„ Unhide Elements';
        z.onclick=()=>{document.querySelectorAll('[disabled],[readonly]').forEach(el=>{el.removeAttribute('disabled');el.removeAttribute('readonly');});document.querySelectorAll('[style*="display: none"],.hidden').forEach(el=>{el.style.display='block';});document.querySelectorAll('[style*="pointer-events: none"],.grayed').forEach(el=>{el.style.pointerEvents='auto';el.style.opacity='1';});alert('âœ… Disabled, readonly, and hidden elements are now active!');};
        let p=document.createElement('label');p.style='display:flex;align-items:center;gap:5px;color:#00bcd4;font-size:14px;cursor:pointer;';
        let b=document.createElement('input');b.type='checkbox',p.appendChild(b),p.appendChild(document.createTextNode('Domain only'));
        y.appendChild(h),y.appendChild(g),y.appendChild(z),y.appendChild(p),n.appendChild(y);
        let w=document.createElement('div');w.id='results',w.style='margin-top:10px;color:#00bcd4;';
        let k=document.createElement('div');k.id='results-wrapper';k.style='background:#222;padding:10px;border-radius:5px;max-height:180px;overflow:auto;margin-top:10px;';
        n.appendChild(w),n.appendChild(k),document.body.appendChild(n);
        let x=new URL(window.location.href).hostname;
        function f(r){'Escape'===r.key&&u()}
        document.addEventListener('keydown',f);
        let totalScripts=0,processedScripts=0,foundSet=new Set,domUrls=[];
        function updateProgress(){w.innerHTML=`<div style="margin:10px 0;color:#00bcd4">Scanning... (${processedScripts}/${totalScripts} scripts processed)</div>`}
        function updateResults(){let arr=[...new Set([...domUrls,...foundSet])];C=arr,T(arr)}
        async function scanExternalScripts(){let scripts=document.getElementsByTagName('script');totalScripts=Array.from(scripts).filter(s=>s.src).length,processedScripts=0;let regex=/["'`]\/*[a-zA-Z0-9_?&=\/\-\#\.]*(?=["'`])/g,promises=[];for(let s of scripts)if(s.src){let ctrl=new AbortController;t.push(ctrl),promises.push(fetch(s.src,{signal:ctrl.signal}).then(r=>r.text()).then(text=>{if(e)return;let matches=text.matchAll(regex);for(let m of matches)foundSet.add(m[0]);processedScripts++,updateProgress(),updateResults()}).catch(err=>{processedScripts++,updateProgress();'AbortError'!==err.name&&console.error(err)}))}await Promise.all(promises)}
        function L(){let e=new Set;document.querySelectorAll('a,script,img,link,form').forEach(t=>{try{t.href&&e.add(t.href)}catch{}try{t.src&&e.add(t.src)}catch{}try{t.action&&e.add(t.action)}catch{}});let n=document.documentElement.innerHTML,o=/(?:url\(|href=|src=|action=|url:|endpoint:|path:|route:)\s*["']?([^"')\s>]+)(?=["'>\s])/gi,i;for(;null!==(i=o.exec(n));)i[1]&&!i[1].startsWith('data:')&&e.add(i[1]);(n.match(/"[^"]*"|'[^']*'/g)||[]).forEach(t=>{let n=/(?:\/[a-zA-Z0-9_-]+)+(?:\.[a-zA-Z0-9]+)?/g,o=t.match(n)||[];o.forEach(t=>e.add(t))}),performance.getEntriesByType('resource').forEach(t=>e.add(t.name));return Array.from(e).sort()}
        function T(n){k.innerHTML='';let o=n.filter(t=>{if(b.checked&&!t.includes(x))return!1;let n=v.value.toLowerCase();return!(n&&!t.toLowerCase().includes(n))});o.forEach(e=>{let t=document.createElement('div');t.style='color:#fff;margin:4px 0;padding:5px;background:#333;border-radius:3px;word-break:break-all;',t.textContent=e,k.appendChild(t)})}
        function U(e){return e.filter(t=>{if(b.checked&&!t.includes(x))return!1;let n=v.value.toLowerCase();return!(n&&!t.toLowerCase().includes(n))})}
        let C=[];
        v.addEventListener('input',()=>T(C)),b.addEventListener('change',()=>T(C));
        h.addEventListener('click',()=>{let e=U(C);navigator.clipboard.writeText(e.join('\n')).then(()=>{alert('âœ… URLs copied!')}).catch(()=>{alert('Copy failed â€” use Export .txt')})});
        g.addEventListener('click',()=>{let e=U(C),t=new Blob([e.join('\n')]),n=document.createElement('a');n.href=URL.createObjectURL(t),n.download='lostsec_urls.txt',n.click()});
        (function init(){w.textContent='Scanning...';domUrls=L(),updateResults(),scanExternalScripts().then(()=>{if(e)return;w.innerHTML=`<div style="margin:10px 0;color:#00bcd4">âœ… Scan complete! Found ${C.length} unique URLs & Endpoints on ${x}</div>`;T(C)}).catch(n=>{if(e)return;console.error(n),w.textContent='âŒ Error during scan. Check console for details.'})})();
      })();
      // if the starter "domain only" checkbox in header is checked, toggle the scanner domain-only checkbox after injection
      setTimeout(()=>{let injected = document.getElementById('lostsec-scanner'); if(injected){ let chk = injected.querySelector('input[type=checkbox]'); if(chk) chk.checked = document.getElementById('start-domain-only').checked } }, 250);
    }
  </script>
</body>
</html>
